# filter {
#   if [type] == "unifi" {
#     grok {
#       match => { "message" => [
#         "^<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{WORD:UniFi_MAC},%{GREEDYDATA:UniFi_Firmware}: %{PROG:Process_name}: \[%{NUMBER:Process_pid}\] \[%{DATA:Process_task}\] DNS request timed out; \[IS: %{COMMONMAC:Client_MAC}\]\[QUERY: %{GREEDYDATA:customer_query}\] \[DNS_SERVER :%{IPV4}\] \[TXN_ID %{DATA:Txn_id}\] \[SRCPORT %{NUMBER:Client_port_origen}\]",
#         "^<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{WORD:UniFi_MAC},%{GREEDYDATA:UniFi_Firmware}: %{PROG:Process_name}: \[%{NUMBER:Process_pid}\] \[%{DATA:Process_task}\] %{GREEDYDATA:Message}",
#         "^<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{WORD:UniFi_MAC},%{GREEDYDATA:UniFi_Firmware}: : %{PROG:Process_name}\[%{NUMBER:Process_pid}\]: wireless_agg_stats.log_sta_anomalies(\): bssid =%{COMMONMAC:BSSID_MAC} radio=%{WORD:BSSID_radio} vap=%{WORD:vap} sta =%{COMMONMAC:Client_MAC} satisfaction_now=%{NUMBER:Customer_satisfaction} anomalies=%{GREEDYDATA:Customer_anomaly}",
#         "^<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{WORD:UniFi_MAC},%{GREEDYDATA:UniFi_Firmware}: : %{PROG:Process_name}\[%{NUMBER:Process_pid}\]: \[%{DATA:Process_task}\].<span class="tr_" id="tr_0" data-source="" data-orig="stahtd_dump_event\">stahtd_dump_event\</span>(\): \{\"query_%{NUMBER:Consulta_id}\":\"%{HOSTNAME:Query_FQDN}\",\"<span class="tr_" id="tr_1" data-source="" data-orig="mac\">mac\</span>":\"%{COMMONMAC:Client_MAC}\",\"<span class="tr_" id="tr_2" data-source="" data-orig="message_type\">message_type\</span>":\"%{DATA:Message_type}\",\"query_server_%{NUMBER:Consulta_id}\":\"%{IPV4:server_ip}\",\"assoc_status":\"%{NUMBER:Association_state}\",\"<span class="tr_" id="tr_3" data-source="" data-orig="vap\">vap\</span>":\"%{WORD:vap}\",\"<span class="tr_" id="tr_4" data-source="" data-orig="event_type\">event_type\</span>":\"%{DATA:Event_type}\"\}",
#         "^<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{WORD:UniFi_MAC},%{GREEDYDATA:UniFi_Firmware}: : %{PROG:Process_name}\[%{NUMBER:Process_pid}\]: \[%{DATA:Process_task}\].<span class="tr_" id="tr_5" data-source="" data-orig="stahtd_dump_event\">stahtd_dump_event\</span>(\): \{\"<span class="tr_" id="tr_6" data-source="" data-orig="dns_resp_seen\">dns_resp_seen\</span>":\"%{WORD:DNS_resp_seen}\",\"<span class="tr_" id="tr_7" data-source="" data-orig="message_type\">message_type\</span>":\"%{DATA:Message_type}\",\"<span class="tr_" id="tr_8" data-source="" data-orig="mac\">mac\</span>":\"%{COMMONMAC:Client_MAC}\",\"<span class="tr_" id="tr_9" data-source="" data-orig="vap\">vap\</span>":\"%{WORD:vap}\",\"assoc_status":\"%{NUMBER:Association_state}\",\"<span class="tr_" id="tr_10" data-source="" data-orig="event_type\">event_type\</span>":\"%{DATA:Event_type}\",\"<span class="tr_" id="tr_11" data-source="" data-orig="event_id\">event_id\</span>":\"%{NUMBER:Evento_id}\",\"<span class="tr_" id="tr_12" data-source="" data-orig="arp_reply_gw_seen\">arp_reply_gw_seen\</span>":\"%{WORD:ARP_resp_seen}\",\"<span class="tr_" id="tr_13" data-source="" data-orig="auth_ts\">auth_ts\</span>":\"%{NUMBER:Auth_ts}\"\}",
#         "^<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{WORD:UniFi_MAC},%{GREEDYDATA:UniFi_Firmware}: : %{PROG:Process_name}\[%{NUMBER:Process_pid}\]: \[%{DATA:Process_task}\].<span class="tr_" id="tr_14" data-source="" data-orig="stahtd_dump_event\">stahtd_dump_event\</span>(\): \{\"query_server_%{NUMBER:Consulta_id}\":\"%{IPV4}\",\"query_%{NUMBER:Consulta_id}\":\"%{HOSTNAME:Query_FQDN}\",\"<span class="tr_" id="tr_15" data-source="" data-orig="mac\">mac\</span>":\"%{COMMONMAC:Client_MAC}\",\"<span class="tr_" id="tr_16" data-source="" data-orig="message_type\">message_type\</span>":\"%{DATA:Message_type}\",\"assoc_status":\"%{NUMBER:Association_state}\",\"<span class="tr_" id="tr_17" data-source="" data-orig="vap\">vap\</span>":\"%{WORD:vap}\",\"<span class="tr_" id="tr_18" data-source="" data-orig="event_type\">event_type\</span>":\"%{DATA:Event_type}\"\}",
#         "^<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{WORD:UniFi_MAC},%{GREEDYDATA:UniFi_Firmware}: : %{PROG:Process_name}\[%{NUMBER:Process_pid}\]: \[%{DATA:Process_task}\].<span class="tr_" id="tr_19" data-source="" data-orig="stahtd_dump_event\">stahtd_dump_event\</span>(\): \{\"query_server_%{NUMBER:Consulta_id}\":\"%{IPV4}\",\"<span class="tr_" id="tr_20" data-source="" data-orig="mac\">mac\</span>":\"%{COMMONMAC:Client_MAC}\",\"<span class="tr_" id="tr_21" data-source="" data-orig="message_type\">message_type\</span>":\"%{DATA:Message_type}\",\"<span class="tr_" id="tr_22" data-source="" data-orig="vap\">vap\</span>":\"%{WORD:vap}\",\"%{DATA:Event_type}\",\"query_%{NUMBER:Consulta_id}\":\"%{HOSTNAME:Query_FQDN}\",\"assoc_status":\"%{NUMBER:Association_state}\"\}",
#         "^<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{WORD:UniFi_MAC},%{GREEDYDATA:UniFi_Firmware}: : %{PROG:Process_name}\[%{NUMBER:Process_pid}\]: \[%{DATA:Process_task}\].<span class="tr_" id="tr_23" data-source="" data-orig="stahtd_dump_event\">stahtd_dump_event\</span>(\): \{\"<span class="tr_" id="tr_24" data-source="" data-orig="mac\">mac\</span>":\"%{COMMONMAC:Client_MAC}\",\"<span class="tr_" id="tr_25" data-source="" data-orig="message_type\">message_type\</span>":\"%{DATA:Message_type}\",\"assoc_status":\"%{NUMBER:Association_state}\",\"<span class="tr_" id="tr_26" data-source="" data-orig="vap\">vap\</span>":\"%{WORD:vap}\",\"<span class="tr_" id="tr_27" data-source="" data-orig="event_type\">event_type\</span>":\"%{DATA:Event_type}\":\"%{NUMBER:Evento_id}\"\}",
#         "^<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{WORD:UniFi_MAC},%{GREEDYDATA:UniFi_Firmware}: : %{PROG:Process_name}\[%{NUMBER:Process_pid}\]: \[%{DATA:Process_task}\].<span class="tr_" id="tr_28" data-source="" data-orig="stahtd_dump_event\">stahtd_dump_event\</span>(\): \{\"<span class="tr_" id="tr_29" data-source="" data-orig="mac\">mac\</span>":\"%{COMMONMAC:Client_MAC}\",\"<span class="tr_" id="tr_30" data-source="" data-orig="message_type\">message_type\</span>":\"%{DATA:Message_type}\",\"<span class="tr_" id="tr_31" data-source="" data-orig="vap\">vap\</span>":\"%{WORD:vap}\",\"query_server_%{NUMBER:Consulta_id}\":\"%{IPV4}\",\"<span class="tr_" id="tr_32" data-source="" data-orig="event_type\">event_type\</span>":\"%{DATA:Event_type}\",\"assoc_status":\"%{NUMBER:Association_state}\",\"query_%{NUMBER:Consulta_id}\":\"%{HOSTNAME:Query_FQDN}\"\}",
#         "^<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{WORD:UniFi_MAC},%{GREEDYDATA:UniFi_Firmware}: : %{PROG:Process_name}\[%{NUMBER:Process_pid}\]: \[%{DATA:Process_task}\].<span class="tr_" id="tr_33" data-source="" data-orig="stahtd_dump_event\">stahtd_dump_event\</span>(\): \{\"<span class="tr_" id="tr_34" data-source="" data-orig="dns_resp_seen\">dns_resp_seen\</span>":\"%{WORD:DNS_resp_seen}\",\"<span class="tr_" id="tr_35" data-source="" data-orig="mac\">mac\</span>":\"%{COMMONMAC:Client_MAC}\",\"<span class="tr_" id="tr_36" data-source="" data-orig="message_type\">message_type\</span>":\"%{DATA:Message_type}\",\"assoc_status":\"%{NUMBER:Association_state}\",\"<span class="tr_" id="tr_37" data-source="" data-orig="vap\">vap\</span>":\"%{WORD:vap}\",\"<span class="tr_" id="tr_38" data-source="" data-orig="event_type\">event_type\</span>":\"%{DATA:Event_type}\",\"<span class="tr_" id="tr_39" data-source="" data-orig="event_id\">event_id\</span>":\"%{NUMBER:Evento_id}\",\"<span class="tr_" id="tr_40" data-source="" data-orig="auth_ts\">auth_ts\</span>":\"%{NUMBER:Auth_ts}\"\}",
#         "^<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{WORD:UniFi_MAC},%{GREEDYDATA:UniFi_Firmware}: : %{PROG:Process_name}\[%{NUMBER:Process_pid}\]: \[%{DATA:Process_task}\].<span class="tr_" id="tr_41" data-source="" data-orig="stahtd_dump_event\">stahtd_dump_event\</span>(\): \{\"<span class="tr_" id="tr_42" data-source="" data-orig="dns_resp_seen\">dns_resp_seen\</span>":\"%{WORD:DNS_resp_seen}\",\"<span class="tr_" id="tr_43" data-source="" data-orig="message_type\">message_type\</span>":\"%{DATA:Message_type}\",\"<span class="tr_" id="tr_44" data-source="" data-orig="mac\">mac\</span>":\"%{COMMONMAC:Client_MAC}\",\"<span class="tr_" id="tr_45" data-source="" data-orig="ip_assign_type\">ip_assign_type\</span>":\"%{DATA:Type_assignment_ip}\",\"<span class="tr_" id="tr_46" data-source="" data-orig="vap\">vap\</span>":\"%{WORD:vap}\",\"assoc_status":\"%{NUMBER:Association_state}\",\"<span class="tr_" id="tr_47" data-source="" data-orig="event_type\">event_type\</span>":\"%{DATA:Event_type}\",\"<span class="tr_" id="tr_48" data-source="" data-orig="auth_ts\">auth_ts\</span>":\"%{NUMBER:Auth_ts}\",\"<span class="tr_" id="tr_49" data-source="" data-orig="wpa_auth_delta\">wpa_auth_delta\</span>":\"%{NUMBER:WPA_auth_delta}\",\"<span class="tr_" id="tr_50" data-source="" data-orig="assoc_delta\">assoc_delta\</span>":\"%{NUMBER:Assoc_delta}\",\"<span class="tr_" id="tr_51" data-source="" data-orig="auth_delta\">auth_delta\</span>":\"%{NUMBER:Auth_delta}\",\"<span class="tr_" id="tr_52" data-source="" data-orig="event_id\">event_id\</span>":\"%{NUMBER:Evento_id}\"\}",
#         "^<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{WORD:UniFi_MAC},%{GREEDYDATA:UniFi_Firmware}: %{PROG:Process_name}: %{WORD:vap}: IS %{COMMONMAC:Client_MAC} %{DATA:Process_task}: %{GREEDYDATA:Message}",
#         "^<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{WORD:UniFi_MAC},%{GREEDYDATA:UniFi_Firmware}: : %{PROG:Process_name}\[%{NUMBER:Process_pid}\]: <span class="tr_" id="tr_53" data-source="" data-orig="wevent.ubnt_custom_event\">wevent.ubnt_custom_event\</span>(\): %{DATA:Event_type} %{WORD:vap}: %{COMMONMAC:Client_MAC} / %{IPV4:customer_ip}",
#         "^<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{WORD:UniFi_MAC},%{GREEDYDATA:UniFi_Firmware}: : %{PROG:Process_name}\[%{NUMBER:Process_pid}\]: <span class="tr_" id="tr_54" data-source="" data-orig="wevent.ubnt_custom_event\">wevent.ubnt_custom_event\</span>(\): %{DATA:Event_type} %{WORD:vap}: %{COMMONMAC:Client_MAC} / %{NUMBER:Evento_id}",
#         "^<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{WORD:UniFi_MAC},%{GREEDYDATA:UniFi_Firmware}: : %{PROG:Process_name}\[%{NUMBER:Process_pid}\]: %{GREEDYDATA:Message}",
#         "^<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{WORD:UniFi_MAC},%{GREEDYDATA:UniFi_Firmware}: %{PROG:Process_name}: %{DATA:Process_task}\[%{NUMBER:Process_pid}\]: %{GREEDYDATA:Task}: %{GREEDYDATA:Message}",
#         "^<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{WORD:UniFi_MAC},%{GREEDYDATA:UniFi_Firmware}: %{PROG:Process_name}: %{DATA:Process_task} %{COMMONMAC:Client_MAC} %{WORD:vap} \(%{GREEDYDATA:Message}\)",
#         "^<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{WORD:UniFi_MAC},%{GREEDYDATA:UniFi_Firmware}: %{UNIXPATH:Process_name}\[%{NUMBER:Process_pid}\]: %{GREEDYDATA:Message}",
#         "^<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{WORD:UniFi_MAC},%{GREEDYDATA:UniFi_Firmware}: %{PROG:Process_name}: \[%{NUMBER:Process_pid}\] %{GREEDYDATA:Message}",
#         "^<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{WORD:UniFi_MAC},%{GREEDYDATA:UniFi_Firmware}: %{PROG:Process_name}: %{DATA:Process_task}: %{GREEDYDATA:Message}"
#       ]}
#     }
#     mutate {
#       convert => {
#         "Customer_satisfaction" => "integer"
#       }
#     }
#   }
# }
